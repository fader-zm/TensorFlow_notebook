## 一 美多商城推荐系统介绍

### 1.1 项目简介

- 背景：网站新上线时的主要推荐业务流实现
- 基础数据层
  - 原数据收集
    - 业务DB：网站业务DB内相关数据
      ​         以美多商城当前数据库中约33万商品数据为基础
    - 日志数据：埋点日志
      - 点击流日志
      - 曝光日志
  - 推荐业务原始数据存储：HDFS
    - 业务DB ==> HDFS：sqoop
    - 日志数据 ==> HDFS/KAFKA：flume
  - 元数据简单的预处理
- 数据处理层
  - 离线计算:
    - 基于内容的物品相似度计算
        - 物品画像、用户画像
        - 行为偏好评分
        - 相关模型训练
  - 在线计算：
    - 实时行为分析
- 推荐业务层
  - 初期:
    - 冷启动
             - 根据商品详细属性等数据，离线计算出商品画像
                 - 根据商品画像的部分属性求出的物品相似度进行推荐与排序(解决物品冷启动)
                 - 热门推荐、新品推荐等非个性化推荐(解决用户冷启动)

  - 中后期: 利用积累的大量用户行为数据，逐渐以离线推荐为主，实时推荐为辅, 协同过滤基于内容推荐结合
    - 离线召回
      - 根据用户点击流日志进行行为偏好评分预估，实现协同过滤推荐

              - 将用户点击流日志结合物品特征进行用户行为特征提取，刻画更加个性化的用户画像

          - 离线模型
              - 利用曝光日志信息结合用户画像和物品画像特征进行点击率/转化率/跳出率等模型训练，进行推荐排序

  - 基于内容推荐处理思路简介

    - 最终目的 通过相似度计算方式 找到相似物品
    - 计算相似度方法
      - 皮尔逊相关系数
      - 余弦相似度
      - 需要得到物品向量
    - 物品向量的计算 （用向量来表示物品）
      - 基于内容： 利用文本检索的方式 
      - 处理思路：
        - 将同一商品的文字描述信息（品类 标题 副标题 ...）从业务数据库中查询出来
        - 将文字描述信息提取关键词  （结巴分词 textrank tf-idf）
        - 将关键词计算出词向量 word2vec
        - 将词向量 转换为 物品向量
          - 如 一件商品10个关键词 将10个关键词的词向量加权求平均得到物品向量
    - 项目效果

### 1.2 实现流程

- 1.业务数据处理

  ① 从业务数据库（MySQL）中 将跟物品文字描述相关的数据导入到hdfs

  ② 从不同表中 将物品信息相关数据 合并到一起 

- 2.物品画像建模

  ① 对物品描述文字信息 进行关键词提取（分词 计算词权重 textrank tf-idf)

  ② 通过word2vec 计算关键词的词向量

  ③ 将词向量转换为物品向量

  ④通过物品向量计算物品相似度 缓存相似度最高的100件商品

- 3.日志采集，日志处理

  - 前端js加入埋点代码，请求后台记录用户行为
  - Flume将用户行为数据采集到HDFS

- 4.实时推荐

  - kafka 对接Flume 将用户的点击日志收集到消息队列
  - spark streaming 实时处理kafka发送来的点击日志

![](/img/recommend1.png)



